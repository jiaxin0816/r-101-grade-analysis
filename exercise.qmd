---
title: "Exercise"
author: "Jiaxin Shen"
format: html
execute: 
  keep-md: true
---

```{r}
#| message: false
here::i_am("r-101-grade-analysis.Rproj")
library(here)
library(vroom) ## or readr
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
```

## Exercise 1

```{r}
#| message: false
grades <- vroom(here("grades.csv"))
```

## Exercise2

```{r}
T1 <- grades |>
  summarise(min_Grade=min(Exam,na.rm=TRUE),
            max_Grade=max(Exam,na.rm=TRUE),
            mean_Grade=mean(Exam,na.rm=TRUE),
            median_Grade=median(Exam,na.rm=TRUE))
knitr::kable(T1)
```

## Exercise 3

```{r}
N <- sum(is.na(grades$Exam))
```
The number of students who did not take the final exam is  `r N`.

## Exercise 4
```{r message=FALSE,warning=FALSE}
ggplot(grades, aes(x = Exam)) +
  geom_bar()+
  xlab("Grade") +
  ylab("Number of the students")
```

## Exercise 5
```{r}
T2 <- grades |>
  group_by(Group) |>
  summarise(number=n())
knitr::kable(T2)
```

## Exercise 6
```{r message=FALSE,warning=FALSE}
ggplot(grades, aes(x = Group)) +
  geom_bar()+
  xlab("Group") +
  ylab("Number of the students")
```

## Exercise 7
```{r message=FALSE,warning=FALSE}
ggplot(grades, aes(x = Exam)) +
  geom_bar()+
  facet_wrap(vars(Group),scales = "free_x")+
  scale_x_continuous(breaks = c(0,5,10,15,20))+
  xlab("Grade")+
  ylab("Number of students")
```

```{r message=FALSE,warning=FALSE}
ggplot(grades, aes(x = Exam, color=Group)) +
  geom_bar()+
  scale_x_continuous(breaks = c(0,5,10,15,20))+
  xlab("Grade")+
  ylab("Number of students")
```

## Exercise 8
```{r}
T3 <- grades |> 
    group_by(`Group`) |>
    summarize(number = sum(is.na(Exam)))
knitr::kable(T3)
```

## Exercise 9
```{r message=FALSE,warning=FALSE}
ggplot(T3, aes(x = Group, y = number)) +
  geom_col()+
  xlab("Group")+
  ylab("Missed Exam")
```

## Exercise 10
```{r}
options(digits=3)
T4 <- grades |>
  pivot_longer(!Id & !Group,names_to = "name", values_to = "Value")
```
